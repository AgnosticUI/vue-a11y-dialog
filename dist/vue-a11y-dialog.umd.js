!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["vue-a11y-dialog"]={},t.Vue)}(this,(function(t,e){"use strict";var i=['a[href]:not([tabindex^="-"])','area[href]:not([tabindex^="-"])','input:not([type="hidden"]):not([type="radio"]):not([disabled]):not([tabindex^="-"])','input[type="radio"]:not([disabled]):not([tabindex^="-"])','select:not([disabled]):not([tabindex^="-"])','textarea:not([disabled]):not([tabindex^="-"])','button:not([disabled]):not([tabindex^="-"])','iframe:not([tabindex^="-"])','audio[controls]:not([tabindex^="-"])','video[controls]:not([tabindex^="-"])','[contenteditable]:not([tabindex^="-"])','[tabindex]:not([tabindex^="-"])'];function o(t){this._show=this.show.bind(this),this._hide=this.hide.bind(this),this._maintainFocus=this._maintainFocus.bind(this),this._bindKeypress=this._bindKeypress.bind(this),this.$el=t,this.shown=!1,this._id=this.$el.getAttribute("data-a11y-dialog")||this.$el.id,this._previouslyFocused=null,this._listeners={},this.create()}function n(t,e){return i=(e||document).querySelectorAll(t),Array.prototype.slice.call(i);var i}function s(t){(t.querySelector("[autofocus]")||t).focus()}function a(){n("[data-a11y-dialog]").forEach((function(t){new o(t)}))}o.prototype.create=function(){return this.$el.setAttribute("aria-hidden",!0),this.$el.setAttribute("aria-modal",!0),this.$el.setAttribute("tabindex",-1),this.$el.hasAttribute("role")||this.$el.setAttribute("role","dialog"),this._openers=n('[data-a11y-dialog-show="'+this._id+'"]'),this._openers.forEach(function(t){t.addEventListener("click",this._show)}.bind(this)),this._closers=n("[data-a11y-dialog-hide]",this.$el).concat(n('[data-a11y-dialog-hide="'+this._id+'"]')),this._closers.forEach(function(t){t.addEventListener("click",this._hide)}.bind(this)),this._fire("create"),this},o.prototype.show=function(t){return this.shown||(this._previouslyFocused=document.activeElement,this.$el.removeAttribute("aria-hidden"),this.shown=!0,s(this.$el),document.body.addEventListener("focus",this._maintainFocus,!0),document.addEventListener("keydown",this._bindKeypress),this._fire("show",t)),this},o.prototype.hide=function(t){return this.shown?(this.shown=!1,this.$el.setAttribute("aria-hidden","true"),this._previouslyFocused&&this._previouslyFocused.focus&&this._previouslyFocused.focus(),document.body.removeEventListener("focus",this._maintainFocus,!0),document.removeEventListener("keydown",this._bindKeypress),this._fire("hide",t),this):this},o.prototype.destroy=function(){return this.hide(),this._openers.forEach(function(t){t.removeEventListener("click",this._show)}.bind(this)),this._closers.forEach(function(t){t.removeEventListener("click",this._hide)}.bind(this)),this._fire("destroy"),this._listeners={},this},o.prototype.on=function(t,e){return void 0===this._listeners[t]&&(this._listeners[t]=[]),this._listeners[t].push(e),this},o.prototype.off=function(t,e){var i=(this._listeners[t]||[]).indexOf(e);return i>-1&&this._listeners[t].splice(i,1),this},o.prototype._fire=function(t,e){var i=this._listeners[t]||[],o=new CustomEvent(t,{detail:e});this.$el.dispatchEvent(o),i.forEach(function(t){t(this.$el,e)}.bind(this))},o.prototype._bindKeypress=function(t){this.$el.contains(document.activeElement)&&(this.shown&&27===t.which&&"alertdialog"!==this.$el.getAttribute("role")&&(t.preventDefault(),this.hide(t)),this.shown&&9===t.which&&function(t,e){var o=function(t){return n(i.join(","),t).filter((function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)}))}(t),s=o.indexOf(document.activeElement);e.shiftKey&&0===s?(o[o.length-1].focus(),e.preventDefault()):e.shiftKey||s!==o.length-1||(o[0].focus(),e.preventDefault())}(this.$el,t))},o.prototype._maintainFocus=function(t){!this.shown||t.target.closest('[aria-modal="true"]')||t.target.closest("[data-a11y-dialog-ignore-focus-trap]")||s(this.$el)},"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):window.requestAnimationFrame?window.requestAnimationFrame(a):window.setTimeout(a,16));const l={name:"Vue3A11yDialog",props:{id:{type:String,required:!0},appRoot:{type:String,required:!0},dialogRoot:{type:String,required:!0},classNames:{type:Object,default:()=>({container:"dialog-container",document:"dialog-content",overlay:"dialog-overlay",element:"dialog-element",title:"dialog-title",closeButton:"dialog-close"})},role:{type:String,required:!1,default:"dialog",validator:t=>["dialog","alertdialog"].includes(t)},titleId:{type:String,default:""},closeButtonLabel:{type:String,default:"Close this dialog window"},closeButtonPosition:{type:String,required:!1,default:"first",validator:t=>["first","last","none"].includes(t)}},emits:["dialogRef"],setup(t,{emit:i}){let n;const s=e.ref(null),a=e.computed((()=>t.dialogRoot||t.appRoot)),l=e.computed((()=>t.titleId||`${t.id}-title`)),d=e.computed((()=>["dialog","alertdialog"].includes(t.role)?t.role:"dialog"));e.onMounted((()=>{(async()=>{await e.nextTick(),n=new o(s.value,a.value||t.appRoot),i("dialogRef",n)})()}));return e.onUnmounted((()=>{n&&n.destroy(),i("dialogRef")})),{dialog:n,close:()=>{n.hide()},portalTarget:a,fullTitleId:l,roleAttribute:d,rootElement:s}}},d=e.createTextVNode(e.toDisplayString("×")),r=e.createTextVNode(e.toDisplayString("×"));l.render=function(t,i,o,n,s,a){return e.openBlock(),e.createBlock(e.Teleport,{to:n.portalTarget},[e.createVNode("div",{id:o.id,class:o.classNames.container,ref:"rootElement",role:n.roleAttribute,"aria-hidden":"true","aria-labelledby":n.fullTitleId},[e.createVNode("div",{"data-a11y-dialog-hide":"",tabIndex:"-1",class:o.classNames.overlay,onClick:i[1]||(i[1]=t=>"alertdialog"===o.role?void 0:n.close)},null,2),e.createVNode("div",{role:"document",class:o.classNames.document},["first"==o.closeButtonPosition?(e.openBlock(),e.createBlock("button",{key:0,"data-a11y-dialog-hide":"",type:"button","aria-label":o.closeButtonLabel,onClick:i[2]||(i[2]=(...t)=>n.close&&n.close(...t)),class:o.classNames.closeButton},[e.renderSlot(t.$slots,"closeButtonContent",{},(()=>[d]))],10,["aria-label"])):e.createCommentVNode("",!0),e.createVNode("p",{id:n.fullTitleId,class:o.classNames.title},[e.renderSlot(t.$slots,"title")],10,["id"]),e.renderSlot(t.$slots,"default"),"last"==o.closeButtonPosition?(e.openBlock(),e.createBlock("button",{key:1,"data-a11y-dialog-hide":"",type:"button","aria-label":o.closeButtonLabel,onClick:i[3]||(i[3]=(...t)=>n.close&&n.close(...t)),class:o.classNames.closeButton},[e.renderSlot(t.$slots,"closeButtonContent",{},(()=>[r]))],10,["aria-label"])):e.createCommentVNode("",!0)],2)],10,["id","role","aria-labelledby"])],8,["to"])};var c={install:t=>{t.component("a11y-dialog",l)}};t.Vue3A11yDialog=l,t.default=c,Object.defineProperty(t,"__esModule",{value:!0}),t[Symbol.toStringTag]="Module"}));
